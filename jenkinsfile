pipeline {   
   agent {
     kubernetes {
      yaml '''
        apiVersion: v1
        kind: Pod
        metadata:
          name: mypod
          namespace: default
        spec:
          serviceAccount: kube-admin
          containers:
          - name: build-agent
            image: careem785/vlx-cd:latest
            command: 
             - cat
            tty: true
      '''
        }
    }


stages {
      stage('deploy'){
        steps {
          container('build-agent'){
          echo "-------------------------------Deployment started---------------------------"
          sh './deploy.sh'
          echo "-------------------------------Deployment completed---------------------------"
          }
        }
      }
  }
}
